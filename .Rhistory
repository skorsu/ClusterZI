update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(0:1, 5),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 5, trh = 0.5)
update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(0:1, 5),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 5, trh = 0.5)
update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(0:1, 5),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 5, trh = 0.5)
update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(0:1, 5),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 5, trh = 0.5)
set.seed(12)
test_dat <- data_sim(N = 500, K = 3, J = 10, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat <- data_sim(N = 50, K = 3, J = 10, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
set.seed(12)
test_dat <- data_sim(N = 50, K = 3, J = 10, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
set.seed(12)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(0:1, 5),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 5, trh = 0.5)
update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(0:1, 50),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 5, trh = 0.5)
update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(0:1, 500),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 5, trh = 0.5)
Rcpp::sourceCpp("src/clusterZI.cpp")
update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(0:1, 500),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 5, trh = 0.5)
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(0:1, 500),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 5, trh = 0.5)
dim(result)
]result
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(0:1, 500),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 20, trh = 0.5)
result
result[1, ]
result[2, ]
result[3, ]
table(result[3, ])
table(rep(0:1, 500), result[3, ])
table(rep(0:1, 500), result[4, ])
table(rep(0:1, 500), result[5, ])
table(rep(0:1, 500), result[20, ])
table(rep(0:1, 500), result[50, ])
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(0:1, 500),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 100, trh = 0.5)
table(rep(0:1, 500), result[10, ])
table(rep(0:1, 500), result[100, ])
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(0:1, 500),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 1000, trh = 0.5)
apply(result, 2, mean)
apply(result, 2, mean) >= 0.5
which(apply(result, 2, mean) >= 0.5)
which(apply(result, 2, mean) >= 0.5) %>% length
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(0:1, 500),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 20, trh = 0.5)
apply(result, 2, mean)
apply(result, 2, mean) >= 0.5
which(apply(result, 2, mean) >= 0.5)
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(1, 1000),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 1, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = rep(1, 1000),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
result
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
set.seed(12)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
set.seed(12)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
set.seed(12)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
set.seed(12)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
set.seed(12)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
set.seed(12)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$w
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
which(apply(result, 2, mean) >= 0.5)
result <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = c(1, rep(0, 999)),
gamma_mat = test_dat$gamma, xi = exp(test_dat$beta), b0w = 10, b1w = 1,
iter_w = 20, trh = 0.5)
result
apply(result, 2, mean)
Rcpp::sourceCpp("src/clusterZI.cpp")
set.seed(12)
test_dat <- data_sim(N = 100, K = 3, J = 1000, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
exp(test_dat$beta)
log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci, b0w = 1, b1w = 1)
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci, b0w = 1, b1w = 1)
test
exp(test_dat$beta) == test
identical(exp(test_dat$beta), test)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci, b0w = 1, b1w = 1)
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
test
matrix(rep(w, 100), ncol = 1000)
matrix(rep(test_dat$ww, 100), ncol = 1000)
matrix(rep(test_dat$w, 100), ncol = 1000)
test_dat$beta
test_dat$beta[test_dat$ci, ]
matrix(rep(test_dat$w, 100), ncol = 1000) * test_dat$beta[test_dat$ci, ]
test_dat$gamma * matrix(rep(test_dat$w, 100), ncol = 1000) * test_dat$beta[test_dat$ci, ]
identical(test_dat$gamma * matrix(rep(test_dat$w, 100), ncol = 1000) * test_dat$beta[test_dat$ci, ], test)
test_dat$gamma * matrix(rep(test_dat$w, 100), ncol = 1000) * test_dat$beta[test_dat$ci, ]
(test_dat$gamma * matrix(rep(test_dat$w, 100), ncol = 1000) * test_dat$beta[test_dat$ci, ])[1, ]
test[1, ]
(test_dat$gamma * matrix(rep(test_dat$w, 100), ncol = 1000) * exp(test_dat$beta[test_dat$ci, ]))[1, ]
test[1, ]
test_dat$gamma
matrix(rep(test_dat$w, 100), ncol = 1000)
(test_dat$gamma * matrix(rep(test_dat$w, 100), ncol = 1000) * exp(test_dat$beta[test_dat$ci, ]))[1, ]
test[1, ]
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
test
set.seed(12)
test_dat <- data_sim(N = 10, K = 3, J = 5, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
set.seed(125)
test_dat <- data_sim(N = 10, K = 3, J = 5, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.5, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
set.seed(12)
test_dat <- data_sim(N = 10, K = 3, J = 5, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.25, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
set.seed(12)
test_dat <- data_sim(N = 10, K = 3, J = 30, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.25, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
test
matrix(rep(test_dat$w, 10), ncol = 30)
matrix(rep(test_dat$w, 10), ncol = 30) %>% t()
matrix(rep(test_dat$w, 10), nrow = 30) %>% t()
Rcpp::sourceCpp("src/clusterZI.cpp")
set.seed(12)
test_dat <- data_sim(N = 10, K = 3, J = 30, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.25, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
(test_dat$gamma * (matrix(rep(test_dat$w, 10), nrow = 30) %>% t()) * exp(test_dat$beta[test_dat$ci, ]))[1, ]
test[1, ]
identical((test_dat$gamma * (matrix(rep(test_dat$w, 10), nrow = 30) %>% t()) * exp(test_dat$beta[test_dat$ci, ])), test)
Rcpp::sourceCpp("src/clusterZI.cpp")
test_dat$w
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
beta(2, 1)
log(beta(2, 1))
std::cout << arma::sum(gwx, 1) << std::endl;
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
gwz <- (test_dat$gamma * (matrix(rep(test_dat$w, 10), nrow = 30) %>% t()) * exp(test_dat$beta[test_dat$ci, ]))
gwz
gwz[, 1]
z[, 1]
test_dat$z[, 1]
(gwz[, 1] + test_dat$z[, 1]) != 0
(gwz[, 1] + test_dat$z[, 1])[(gwz[, 1] + test_dat$z[, 1]) != 0]
sum(lgamma((gwz[, 1] + test_dat$z[, 1])[(gwz[, 1] + test_dat$z[, 1]) != 0]))
sum(lgamma(gwz[, 1][gwz[, 1] != 0]))
rowSums(gwz)
lgamma(rowSums(gwz))
sum(lgamma(rowSums(gwz)))
sum(lgamma(rowSums(test_dat$z + gwz)))
test_dat$w
log(beta(2, 1)) +
sum(lgamma((gwz[, 1] + test_dat$z[, 1])[(gwz[, 1] + test_dat$z[, 1]) != 0])) -
sum(lgamma(gwz[, 1][gwz[, 1] != 0]))
log(beta(2, 1)) +
sum(lgamma((gwz[, 1] + test_dat$z[, 1])[(gwz[, 1] + test_dat$z[, 1]) != 0])) -
sum(lgamma(gwz[, 1][gwz[, 1] != 0])) +
sum(lgamma(rowSums(gwz))) -
sum(lgamma(rowSums(test_dat$z + gwz)))
log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
set.seed(12)
test_dat <- data_sim(N = 1000, K = 3, J = 30, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.25, s2 = 1, lb_a = 10, ub_a = 20, lb_ia = 5, ub_ia = 10)
test_dat$z
set.seed(12)
test_dat <- data_sim(N = 1000, K = 3, J = 500, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.65, s2 = 1, lb_a = 500, ub_a = 1000, lb_ia = 250, ub_ia = 350)
test_dat$z
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
test
exp(test)
test
test_dat$z
test_dat$z[, 1]
cbind(test_dat$z[, 1], test_dat$w)
new_w <- test_dat$w
test_dat$w
new_w[1] <- 0
test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = test_dat$w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
new_w <- test_dat$w
new_w[1] <- 0
new_test <- log_wj(j = 0, z = test_dat$z, gamma_mat = test_dat$gamma, w = new_w,
beta = test_dat$beta, clus_assign = test_dat$ci - 1, b0w = 1, b1w = 1)
new_test
new_test - test
test
exp(new_test - test)
Rcpp::sourceCpp("src/clusterZI.cpp")
update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, xi = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, xi = test_dat$beta, b0w = 1, b1w = 1)
set.seed(12)
test_dat <- data_sim(N = 100, K = 3, J = 40, clus_prop = c(0.3, 0.4, 0.3),
pi_g = c(0.75, 0.9, 0.5), pi_w = 0.65, s2 = 1, lb_a = 500, ub_a = 1000, lb_ia = 250, ub_ia = 350)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, xi = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, xi = test_dat$beta, b0w = 1, b1w = 1)
update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, xi = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, xi = test_dat$beta, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = rep(1, 50),
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = rep(1, 50),
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = rep(0, 50),
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = rep(0, 50),
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = rep(0, 50),
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = rep(0, 50),
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = rep(0, 50),
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = rep(1, 50),
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = rep(1, 50),
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci, old_w = rep(1, 40),
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test_dat$z
test_dat$ci
rep(1, 40)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$ci,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
Rcpp::sourceCpp("src/clusterZI.cpp")
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
test <- update_w(z = test_dat$z, clus_assign = test_dat$ci - 1, old_w = test_dat$w,
gamma_mat = test_dat$gamma, beta = test_dat$beta, b0w = 1, b1w = 1)
table(test, test_dat$w)
